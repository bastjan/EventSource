/** @license
 * eventsource.js
 * Available under MIT License (MIT)
 * https://github.com/Yaffle/EventSource/
 */
!function(a){"use strict";function b(){this.data={}}function c(){this.listeners=new b}function d(a){setTimeout(function(){throw a},0)}function e(a){this.type=a,this.target=void 0}function f(a,b){e.call(this,a),this.data=b.data,this.lastEventId=b.lastEventId}function g(a,b){var c=a;return c!==c&&(c=b),z>c?z:c>A?A:c}function h(a,b,c){try{"function"==typeof b&&b.call(a,c)}catch(e){d(e)}}function i(b,d){function i(){M=s,void 0!==I&&(I.abort(),I=void 0),0!==J&&(clearTimeout(J),J=0),0!==K&&(clearTimeout(K),K=0),F.readyState=s}function j(a){var c=M===r||M===q?I.responseText:"",d=void 0;if(M===q){var i=0,j="",k=void 0;if(n)try{i=I.status,j=I.statusText,k=I.getResponseHeader("Content-Type")}catch(l){i=0,j="",k=void 0}else""!==a&&"error"!==a&&(i=200,j="OK",k=I.contentType);if((void 0===k||null===k)&&(k=""),0===i&&""===j&&"load"===a&&""!==c&&(i=200,j="OK",""===k)){var m=/^data\:([^,]*?)(?:;base64)?,[\S]*$/.exec(b);void 0!==m&&null!==m&&(k=m[1])}if(200===i&&y.test(k)){if(M=r,H=!0,G=C,F.readyState=r,d=new e("open"),F.dispatchEvent(d),h(F,F.onopen,d),M===s)return}else if(0!==i){var o="";o=200!==i?"EventSource's response has a status "+i+" "+j.replace(/\s+/g," ")+" that is not 200. Aborting the connection.":"EventSource's response has a Content-Type specifying an unsupported type: "+k.replace(/\s+/g," ")+". Aborting the connection.",setTimeout(function(){throw new Error(o)},0)}}if(M===r){c.length>L&&(H=!0);for(var z=L-1,B=c.length,K="\n";++z<B;)if(K=c.charAt(z),R===t&&"\n"===K)R=u;else if(R===t&&(R=u),"\r"===K||"\n"===K){if("data"===S?N.push(T):"id"===S?O=T:"event"===S?P=T:"retry"===S?(C=g(Number(T),C),G=C):"heartbeatTimeout"===S&&(D=g(Number(T),D),0!==J&&(clearTimeout(J),J=setTimeout(Q,D))),T="",S="",R===u){if(0!==N.length&&(E=O,""===P&&(P="message"),d=new f(P,{data:N.join("\n"),lastEventId:O}),F.dispatchEvent(d),"message"===P&&h(F,F.onmessage,d),M===s))return;N.length=0,P=""}R="\r"===K?t:u}else R===u&&(R=v),R===v?":"===K?R=w:S+=K:R===w?(" "!==K&&(T+=K),R=x):R===x&&(T+=K);L=B}M!==r&&M!==q||!("load"===a||"error"===a||L>1048576||0===J&&!H)?0===J&&(H=!1,J=setTimeout(Q,D)):(M=p,I.abort(),0!==J&&(clearTimeout(J),J=0),G>16*C&&(G=16*C),G>A&&(G=A),J=setTimeout(Q,G),G=2*G+1,F.readyState=q,d=new e("error"),F.dispatchEvent(d),h(F,F.onerror,d))}function k(){j("progress")}function l(){j("load")}function z(){j("error")}b=b.toString();var B=m&&void 0!==d&&Boolean(d.withCredentials),C=g(1e3,0),D=g(45e3,0),E="",F=this,G=C,H=!1,I=new o,J=0,K=0,L=0,M=p,N=[],O="",P="",Q=void 0,R=u,S="",T="";n&&(K=setTimeout(function U(){3===I.readyState&&j("progress"),K=setTimeout(U,500)},0)),Q=function(){if(J=0,M!==p)return void j("");if(n&&(void 0!==I.sendAsBinary||void 0===I.onloadend)&&void 0!==a.document&&void 0!==a.document.readyState&&"complete"!==a.document.readyState)return void(J=setTimeout(Q,4));I.onload=l,I.onerror=z,n&&(I.onabort=z,I.onreadystatechange=k),I.onprogress=k,H=!1,J=setTimeout(Q,D),L=0,M=q,N.length=0,P="",O=E,T="",S="",R=u;var c=b.slice(0,5);c="data:"!==c&&"blob:"!==c?b+((-1===b.indexOf("?",0)?"?":"&")+"lastEventId="+encodeURIComponent(E)+"&r="+(Math.random()+1).toString().slice(2)):b,I.open("GET",c,!0),n&&(I.withCredentials=B,I.responseType="text",I.setRequestHeader("Accept","text/event-stream")),I.send(void 0)},c.call(this),this.close=i,this.url=b,this.readyState=q,this.withCredentials=B,this.onopen=void 0,this.onmessage=void 0,this.onerror=void 0,Q()}function j(){this.CONNECTING=q,this.OPEN=r,this.CLOSED=s}b.prototype={get:function(a){return this.data[a+"~"]},set:function(a,b){this.data[a+"~"]=b},"delete":function(a){delete this.data[a+"~"]}},c.prototype={dispatchEvent:function(a){a.target=this;var b=a.type.toString(),c=this.listeners,e=c.get(b);if(void 0!==e)for(var f=e.length,g=-1,h=void 0;++g<f;){h=e[g];try{h.call(this,a)}catch(i){d(i)}}},addEventListener:function(a,b){a=a.toString();var c=this.listeners,d=c.get(a);void 0===d&&(d=[],c.set(a,d));for(var e=d.length;--e>=0;)if(d[e]===b)return;d.push(b)},removeEventListener:function(a,b){a=a.toString();var c=this.listeners,d=c.get(a);if(void 0!==d){for(var e=d.length,f=[],g=-1;++g<e;)d[g]!==b&&f.push(d[g]);0===f.length?c["delete"](a):c.set(a,f)}}},f.prototype=e.prototype;var k=a.XMLHttpRequest,l=a.XDomainRequest,m=void 0!==k&&void 0!==(new k).withCredentials,n=m,o=m?k:void 0!==l?l:void 0,p=-1,q=0,r=1,s=2,t=3,u=4,v=5,w=6,x=7,y=/^text\/event\-stream;?(\s*charset\=utf\-8)?$/i,z=1e3,A=18e6;j.prototype=c.prototype,i.prototype=new j,j.call(i),a.NativeEventSource=a.EventSource,a.EventSource=i}(this);